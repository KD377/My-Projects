<!DOCTYPE html>
<html lang="pl">
  <head>
    <meta charset="utf-8"/>
    <link rel="stylesheet" href="style.css"/>
    <title>Rewind</title>
  </head>
  <body>
    <div id="container">
      <div id="header">
        Technologie XML<br>
        <p>Rewind by Krzysztof Deka</p>
      </div>
      <div id="menubar">
        <div onclick="scrollTo1()" class="menucontent">Zadanie 1</div>
        <div onclick="scrollTo1()" class="menucontent">Zadanie 2</div>
        <div onclick="scrollTo3()" class="menucontent">Zadanie 3</div>
        <div onclick="scrollTo4()" class="menucontent">Zadanie 4</div>
        <div onclick="scrollTo5()" class="menucontent">Zadanie 5</div>
      </div>
      <div id="content">
        <div id="element1" class="zad">
          <h1>Zadanie 1 & 2</h1>
          <div class="wrapper">
            <div class="description">
              Zadanie pierwsze polegalo na utworzeniu walsnej struktury xml z ronymi rodzajami znacznikow.
              Byl to wstep do zadania 2 w ktorym zawartosc pliku xml z zadania 1 zostala rozszsrzona o kolejne elementy.
              Następnie dodano plik XML Schema dbający o poprawność danych oraz arkusz styli, który zadbał o wyświetlenie oraz wygląd.
            </div>
            <div class="file">
              zoo
              {
                background-image: url("t.jpeg");
                background-attachment: fixed;
                background-size: cover;
                width:100%;
                font-family: arial;
                /*background-color: #1A1A1D;*/
                color: #FFF;
                font-size: 16px;
              }

              header
              {
                  font-size: 60px;
                  display: block;
                  background-color: #0B0C10;
                  width:100%;
                  margin:0px;
                  color:#FFF;
                  border-bottom: 2px solid #000;
              }

              header > autor,nrIndeksu,dataModyfikacji
              {
                text-align: center;
                display: block;
                text-shadow: 2px 2px red;
              }
              header > autor
              {
                padding-top: 25px;
                font-weight: bold;
              }

              header > nrIndeksu,dataModyfikacji
              {
                font-size: 25px;
                padding: 10px;
              }

              zwierzeta
              {
                margin:20px;
                background-color: transparent;
                display: block;
              }

              zwierzeta::before
              {
                content: "Zwierzęta";
                font-size: 50px;
                font-weight: bold;
                text-align: center;
                display: block;
                margin-bottom: 20px;
                text-shadow: 2px 2px red;
              }

              zwierzeta > zwierze
              {
                background-color: #41B3A3;
                text-align: center;
                display: inline-block;
                padding-top: 10px;
                width:40%;
                counter-increment: zwierze;
                margin-left:5%;
                margin-top: 20px;
                margin-bottom: 20px;
                padding-bottom: 0px;
                -moz-box-shadow: 2px 3px 4px rgba(0,0,0,2);
                -webkit-box-shadow: 2px 3px 4px rgba(0,0,0,2);
                box-shadow: 2px 3px 4px rgba(0,0,0,2);
              }

              zwierze::after
              {
                content: "Gatunek: " attr(idG)
                ", Numer wybiegu: " attr(idWybiegu);
                border-top: solid 3px #fff;
                display: inline-block;
                text-align: center;
                font-size: 18px;
                background-color: #222629;
                padding-top: 10px;
                padding-bottom: 10px;
                width:100%;
                height:30px;
                margin-top: 10px;
              }


              zwierze[class="1"]
              {
                background-color: #CB2D6F;
              }

              zwierze[class="2"]
              {
                background-color: #e8834d;/*10E7DC*/
              }

              zwierze[class="3"]
              {
                background-color: #2F2FA2;/*0074E1*/
              }

              zwierze[class="4"]
              {
                background-color: #C3073F;
              }

              zwierze[class="1"]>*:hover
              {
                text-shadow:  0px 0px 10px #CB2D6F;
              }

              zwierze[class="2"]>*:hover
              {
                text-shadow:  0px 0px 10px #e8834d;/*10E7DC*/
              }

              zwierze[class="3"]>*:hover
              {
                text-shadow:  0px 0px 10px #2F2FA2;/*0074E1*/
              }

              zwierze[class="4"]>*:hover
              {
                text-shadow:  1px 1px 10px #C3073F;
              }

              zwierze > nazwaZwierzecia,imie,wiek,waga,dataUrodzenia
              {
                display: block;
                padding: 5px;
                float: left;
                font-size: 20px;
                background-color: #1A1A1D;
                margin-left: 5%;
                margin-right: 5%;
                padding-top: 10px;
                padding-bottom: 10px;
                margin-top: 2%;
                margin-right: 2%;
                width:90%;
                -moz-box-shadow: 2px 3px 4px rgba(0,0,0,2);
                -webkit-box-shadow: 2px 3px 4px rgba(0,0,0,2);
                box-shadow: 2px 3px 4px rgba(0,0,0,2);
                border-radius: 25px;
              }


              nazwaZwierzecia
              {
                font-size: 40px !IMPORTANT;
                font-weight: bold;
              }

              nazwaZwierzecia::first-letter
              {
                color: #FF4E4E;
              }

              nazwaZwierzecia::before
              {
                content: counter(zwierze) " ";
              }

              imie::before
              {
                content: "Imie: ";
                font-size: 20px;
                font-family: cursive;
              }

              wiek::before
              {
                content: "Wiek: ";
                font-size: 20px;
                font-family: cursive;
              }

              waga::before
              {
                content: "Waga: ";
                font-size: 20px;
                font-family: cursive;
              }

              dataUrodzenia::before
              {
                content: "Data urodzenia: ";
                font-size: 20px;
                font-family: cursive;
              }

              wybiegi
              {
                display: block;
                width:100%;
                text-align: center;
                padding-top: 10px;
                padding-bottom: 10px;
              }

              wybiegi::before
              {
                content: "Wybiegi";
                font-size: 50px;
                font-weight: bold;
                display: block;
                margin-bottom: 20px;
                text-shadow: 2px 2px red;
              }

              wybiegi > wybieg
              {
                display: inline-block;
                width: 30%;
                margin-left: 5%;
                font-size: 20px;
                margin-right: 5%;
                background-color: rgba(34,38, 41, 0.6);
                margin-top: 10px;
                margin-bottom: 10px;
                padding-top: 5px;
                transition: background-color 0.7s ease-out ;
              }

              wybieg:hover
              {
                background-color: rgba(195,7, 63, 1);
              }

              wybieg::before
              {
                  content: "Wybieg " attr(idWybiegu);
                  font-size: 30px;
                  font-weight: bold;
                  display: block;
                  text-shadow: 2px 2px #000;
              }

              wybieg > sektor,powierzchnia,typ
              {
                display: inline-block;
                margin: 5px;
                padding: 5px;
              }

              sektor::before
              {
                content: "sektor: ";
              }

              powierzchnia::before
              {
                content: "powierzchnia: ";
              }

              typ::before
              {
                content: "typ: ";
              }
              powierzchnia::after
              {
                content: " " attr(jednostka);
              }
              gatunki
              {
                display: block;
                background-color: #0B0C10;
                width: 100%;
                padding-top: 50px;
                padding-bottom: 50px;
                text-align: center;
              }

              gatunki::before
              {
                content: "Gatunki";
                display: block;
                font-size: 50px;
                padding: 30px;
                font-weight: bold;
                text-shadow: 2px 2px rgba(195,7, 63, 1);
              }

              gatunki > gatunek
              {
                width:10%;
                display: inline-block;
                margin-left: auto;
                margin-right: auto;
                font-size: 30px;
                margin-bottom: 20px;
                margin-bottom: 20px;
                border-left: 2px dashed #FFF;
                transition: text-shadow  0.5s ease, font-weight 0.5s ease;
              }

              gatunek[idG="05"]
              {
                border-right: 2px dashed #FFF;
              }

              gatunek:hover
              {
                text-shadow: 3px 3px rgba(195,7, 63, 1);
                font-weight: bold;
              }

            </div>
            <input style="display:none;" type="file" id="myFileInput">
          </div>
          <div class="buttons">
            <button class="button-88" role="button"><a href="../zoo.xml" target="_blank">Zoo</a></button>
            <button class="button-88" role="button"><a href="../zoo1.xml" target="_blank">Zoo (Zad 1)</a></button>
            <button class="button-88" role="button"><a href="../zoo.xsd" target="_blank">XML Schema</a></button>
          </div>
        </div>
        <div id="element3" class="zad">
          <h1>Zadanie 3</h1>
          <div class="wrapper">
            <div class="description">
              Zadanie trzecie polegało na przygotowaniu transformacji dokumentu xml.
              Najpierw do dokumentu XMl w innym formacie prezentującym statystyki, a następnie trzy transformacje
              wcześniej przygotowanego raportu do XHTML, TXT oraz SVG. Wszytskie wyniki można zobaczyć poniżej klikając w jeden z 4 guzików.
            </div>
            <div class="file">
              <pre id="file-content"></pre>
            </div>
          </div>
          <div class="buttons">
            <input type="file" id="fileInput">
            <button class="button-88" role="button"><a href="../zooRaport.xml" target="_blank">Raport XML</a></button>
            <button class="button-88" role="button"><a href="../zooRaport.xhtml" target="_blank">Raport XHMTL</a></button>
            <button class="button-88" role="button"><a href="../zooRaport.txt" target="_blank">Raport TXT</a></button>
            <button class="button-88" role="button"><a href="../zoo.svg" target="_blank">Wizualizacja SVG</a></button>
          </div>
        </div>
        <div id="element4" class="zad">
          <h1>Zadanie 4</h1>
          <div class="wrapper">
            <div class="description">
              Zadanie czwarte polegało na przygotowaniu gry wykorzystując grafikę wektorową SVG oraz JavaScript.
              Aby zagrać należy wcisnąć przycisk.
            </div>
            <div class="file" id="file-content">
              var player = document.getElementById('player');
              var points = 0;
              var lives=3;
              var shotSpeed = 1;
              var currentEnemies;
              var maxEnemies=6;
              var countCall;
              var isBegin;
              var isOver = false;
              var isLeft = [];
              var enemies = [];
              var enemyColor = ["#f54e42", "#f5e149","#49f54f","#49f5ea", "#4248f5", "#fc03ec"];
              var rightInterval;
              var leftInterval;
              var moveInterval;
              var beginInterval;
              var overInterval;
              var shots = document.getElementById('shots');
              var info = document.getElementById('info');
              var enemyShots = document.getElementById('enemyShots');
              var enemiesGr = document.getElementById('enemies');
              var svg = document.getElementById('svg');
              var score = document.getElementById('score');
              var offset=0;
              var spawnOffset=0;

              let shotSound= new Audio('shot.mp3');
              shotSound.preload = 'auto';

              let gameSound= new Audio('graTlo.mp3');
              gameSound.preload = 'auto';

              let pointSound= new Audio('point.mp3');
              pointSound.preload = 'auto';

              let deathSound= new Audio('death.mp3');
              deathSound.preload = 'auto';

              let menuSound= new Audio('menu.mp3');
              menuSound.preload = 'auto';

              function playSound(sound, volume) {
                var click = sound.cloneNode();
                click.volume = volume;
                click.play();
                return click;
              }

              function random (minInt, maxInt) {
                return Math.floor(Math.random() * (maxInt - minInt)) + minInt;
              }

              function playerShot(x) {
                var item = document.createElementNS("http://www.w3.org/2000/svg", "rect");
                item.x.baseVal.value = x + 14;
                item.y.baseVal.value = 334;
                item.width.baseVal.value = 2;
                item.height.baseVal.value = 10;
                item.style.fill = "#fc6f03";
                shots.appendChild(item);
                return item;
              }

              function enemyShot(enemy) {
                var item = document.createElementNS("http://www.w3.org/2000/svg", "rect");
                item.x.baseVal.value = enemy.x.baseVal.value + 19;
                item.y.baseVal.value = enemy.y.baseVal.value + 10;
                item.width.baseVal.value = 2;
                item.height.baseVal.value = 10;
                item.style.fill = enemy.style.fill;
                enemyShots.appendChild(item);
                return item;
              }

              function playerColision(shot) {
                var isHit = false;
                  var area = (shot.x.baseVal.value >= player.x.baseVal.value) && (shot.x.baseVal.value <= player.x.baseVal.value + player.width.baseVal.value);
                  if (shot.y.baseVal.value + shot.height.baseVal.value <= player.y.baseVal.value + player.height.baseVal.value &&
                    (shot.y.baseVal.value >= player.y.baseVal.value) && area) {
                    isHit=true
                    enemyShots.removeChild(shot);
                    if(lives > 0 && isBegin == false){
                      lives--;
                      document.getElementById('lives').textContent = lives;
                    }
                  }
                return isHit;
              }

              function enemyFire(index) {
                var thisShot = enemyShot(enemies[index]);
                var interval = setInterval(function(){
                  thisShot.y.baseVal.value += shotSpeed;
                  if(thisShot.y.baseVal.value == 360)
                  {
                    clearInterval(interval);
                    enemyShots.removeChild(thisShot);
                  }
                  else if(playerColision(thisShot)){
                    clearInterval(interval);
                  }
                },5);
              }

              function killEnemy(index) {
                enemiesGr.removeChild(enemies[index]);
                enemies[index] = null;
                currentEnemies -=1;
              }

              function shotColision(shot) {
                var isHit = false;
                for(var i = maxEnemies - 1; i >= 0; i--) {
                  var en = enemies[i];
                  if(en == null) continue;
                  var area = (shot.x.baseVal.value >= en.x.baseVal.value) && (shot.x.baseVal.value <= en.x.baseVal.value + en.width.baseVal.value);
                  if (shot.y.baseVal.value <= en.y.baseVal.value + en.height.baseVal.value &&
                    (shot.y.baseVal.value >= en.y.baseVal.value) && area) {
                    isHit=true
                    playSound(pointSound,0.6);
                    points += 15;
                    if(lives > 0)
                      document.getElementById('score').textContent = points;
                    shots.removeChild(shot);
                    killEnemy(i);
                    break;
                  }
                }
                return isHit;
              }

              function shot() {
                var thisShot = playerShot(player.x.baseVal.value);
                var interval = setInterval(function(){
                  thisShot.y.baseVal.value -= shotSpeed;
                  if(thisShot.y.baseVal.value == 40)
                  {
                    clearInterval(interval);
                    shots.removeChild(thisShot);
                  }
                  else if (shotColision(thisShot)) {
                    clearInterval(interval);
                  }
                },5);
              }

              function movePlayerRight() {
                rightInterval = setInterval(function(){
                  if (player.x.baseVal.value < 508)
                    player.x.baseVal.value += 2;
                  else if (player.x.baseVal.value >= 508) {
                    clearInterval(rightInterval);
                  }
                },5)
              }

              function movePlayerLeft() {
                leftInterval = setInterval(function(){
                  if(player.x.baseVal.value > 60)
                    player.x.baseVal.value -= 2;
                  else if(player.x.baseVal.value <= 60)
                  {
                    clearInterval(leftInterval);
                  }
                },5)
              }

              function spawnEnemy(index) {
                var enemy = document.createElementNS("http://www.w3.org/2000/svg", "rect");
                var randomx = random(60,441);
                var randomy = random(50,123);
                currentEnemies += 1;
                enemy.x.baseVal.value = randomx;
                enemy.y.baseVal.value = randomy;
                enemy.width.baseVal.value = 40;
                enemy.height.baseVal.value = 12;
                enemy.style.stroke = "#000000";
                enemy.style.fill = enemyColor[index];
                enemies[index]=enemy;
                enemiesGr.appendChild(enemy);
                return enemy;
              }

              function moveEnemy(index){
                if(enemies[index] == null)
                  return;
                var en = enemies[index];
                if(isLeft[index] == false)
                  en.x.baseVal.value += 1;
                else if (isLeft[index] == true) {
                  en.x.baseVal.value -= 1;
                }

                if (en.x.baseVal.value >= 500)
                  isLeft[index] = true;
                else if (en.x.baseVal.value <= 60) {
                  isLeft[index] = false;
                }
              }

              function gameOver(){
                isOver = true;
                deathSound.play();
                menuSound.play();
                menuSound.volume = 0.6;
                var count = 0;
                document.getElementById('gameOver').style.fill = "#FFFFFF";
                document.getElementById('gameOver1').style.fill = "#FFFFFF";
                document.getElementById('collectedPoints').textContent = points;
                document.getElementById('collectedPoints').style.fill = "#FFFFFF";
                document.getElementById('playAgain').style.fill = "#FFFFFF";
                document.getElementById('gameBoard').style.opacity = "0.3";
                overInterval = setInterval(function(){
                  rand=random(0,6);
                  if(count == 2) count =0;
                  count++;
                  document.getElementById('title').style.fill = enemyColor[rand];
                  if(count%2 == 0)
                    document.getElementById('gameOver').style.fill = "#FFFFFF";
                  else {
                    document.getElementById('gameOver').style.fill = "#f54e42";
                  }
                },500)
              }

              function begin() {
                isBegin=true;
                var rand;
                var m=0;
                var e;
                document.getElementById('welcome').style.fill = "#FFFFFF";
                document.getElementById('welcome1').style.fill = "#FFFFFF";
                document.getElementById('play').style.fill = "#FFFFFF";
                document.getElementById('gameBoard').style.opacity = "0.3";
                menuSound.play();
                menuSound.volume = 0.6;
                beginInterval = setInterval(function(){
                  if(m == 6) {
                    m=0;
                  }
                  if(enemies[m] != null)
                    killEnemy(m);
                  spawnEnemy(m);
                  for(var k = 0; k < 6; k++){
                    if(enemies[k] != null)
                      enemyFire(k);
                  }
                  rand=random(0,6);
                  document.getElementById('title').style.fill = enemyColor[rand];
                  m++;
                },500)
              }

              function start() {
                menuSound.pause();
                menuSound.currentTime = 0;
                for(var i = 0; i < 6; i++){
                  if(enemies[i] != null)
                    killEnemy(i);
                }
                var rand;
                var music;
                isBegin = false;
                isOver = false;
                points = 0;
                lives = 3;
                shotSpeed = 1;
                currentEnemies = 0;
                maxEnemies = 6;
                spawnOffset=0;
                offset=0;
                document.getElementById('welcome').style.fill = "transparent";
                document.getElementById('welcome1').style.fill = "transparent";
                document.getElementById('play').style.fill = "transparent";
                document.getElementById('gameBoard').style.opacity = "1";
                document.getElementById('gameOver').style.fill = "transparent";
                document.getElementById('gameOver1').style.fill = "transparent";
                document.getElementById('collectedPoints').style.fill = "transparent";
                document.getElementById('playAgain').style.fill = "transparent";
                document.getElementById('lives').textContent = lives;
                for(var i = 0; i < 6; i++){
                  spawnEnemy(i);
                  rand = random(0,6);
                  if(rand%2 == 0)
                    isLeft[i] = false;
                  else {
                    isLeft[i] = true;
                  }
                }
                  gameSound.play();
                  gameSound.volume=0.2;
                  moveInterval = setInterval(function(){
                  offset++;
                  spawnOffset++;
                  if(lives == 0){
                    clearInterval(moveInterval);
                    gameSound.pause();
                    gameSound.currentTime =0;
                    gameOver();
                  }
                  if(offset ==81) offset=0;
                  if(spawnOffset==200) spawnOffset=0;
                  if(offset == 40 || offset == 80) {
                    rand=random(0,6);
                    document.getElementById('title').style.fill = enemyColor[rand];
                  }
                  if(enemies[0] != null){
                    moveEnemy(0);
                    if(offset == 1){
                      enemyFire(0);
                    }
                  }
                  else if(enemies[0] == null && spawnOffset == 100){
                    spawnEnemy(0);
                  }
                  if(enemies[1] != null){
                    moveEnemy(1);
                    if(offset == 15){
                      enemyFire(1);
                    }
                  }
                  else if(enemies[1] == null && spawnOffset == 100){
                    spawnEnemy(1);
                  }
                  if(enemies[2] != null){
                    moveEnemy(2);
                    if(offset == 30){
                      enemyFire(2);
                    }
                  }
                  else if(enemies[2] == null && spawnOffset == 100){
                    spawnEnemy(2);
                  }
                  if(enemies[3] != null){
                    moveEnemy(3);
                    if(offset == 45){
                      enemyFire(3);
                    }
                  }
                  else if(enemies[3] == null && spawnOffset == 100){
                    spawnEnemy(3);
                  }
                  if(enemies[4] != null){
                    moveEnemy(4);
                    if(offset == 60){
                      enemyFire(4);
                    }
                  }
                  else if(enemies[4] == null && spawnOffset == 100){
                    spawnEnemy(4);
                  }
                  if(enemies[5] != null){
                    moveEnemy(5);
                    if(offset == 75){
                      enemyFire(5);
                    }
                  }
                  else if(enemies[5] == null && spawnOffset == 100){
                    spawnEnemy(5);
                  }
                },10);
              }

              window.addEventListener("load",begin());

              window.addEventListener('keydown', (event)=>{
                switch (event.key) {
                  case 'ArrowLeft':
                    if(player.x.baseVal.value > 60) {
                      if (countCall == 0){
                        clearInterval(rightInterval);
                        clearInterval(leftInterval);
                        movePlayerLeft();
                        countCall += 1;
                      }
                    } break;
                  case 'ArrowRight':
                    if(player.x.baseVal.value < 508){
                      if (countCall == 0)
                      {
                        clearInterval(rightInterval);
                        clearInterval(leftInterval);
                        movePlayerRight();
                        countCall +=1;
                      }
                    } break;
                    case ' ':
                      if(isBegin == true){
                        clearInterval(beginInterval);
                        setTimeout(start(),3000);
                      }
                      else{
                        playSound(shotSound,0.1);
                        shot();
                        break;
                      }
                    case 'r':
                      clearInterval(moveInterval);
                      clearInterval(overInterval);
                      start();
                      break;
                }
              })

              window.addEventListener('keyup',(event)=>{
                switch(event.key){
                  case 'ArrowLeft': clearInterval(leftInterval); countCall = 0; break;
                  case 'ArrowRight': clearInterval(rightInterval); countCall = 0; break;
                }
              })

            </div>
          </div>
          <div class="buttons">
            <button class="button-88" role="button"><a href="../gra.svg" target="_blank">Zagraj!</a></button>
          </div>
        </div>
        <div id="element5" class="zad">
          <h1>Zadanie 5</h1>
          <div class="wrapper">
            <div class="description">
              Zadanie 5 to forumalrz zezwalający na edycję, dodawanie oraz usuwanie elementów z dokumentu XML.
              Ponadto dane musza być zgodne z wcześniej ustalonymi paternami.
            </div>
            <div class="file" id="file-content">
              const fileInput = document.getElementById('plik');
              const loadButton = document.getElementById('loadButton');
              let fileContent = null;
              const saveButton = document.getElementById("saveButton");
              const addButton = document.querySelector('[name="addButton"]');
              const addRunButton = document.getElementById('addRun');
              let nazwa = document.getElementById('nazwa');
              let imie = document.getElementById('imie');
              let wiek = document.getElementById('wiek');
              let waga = document.getElementById('waga');
              let data = document.getElementById('data');
              let sektor = document.getElementById('sektor');
              let powierzchnia = document.getElementById('powierzchnia');
              let typ = document.getElementById('typ');
              let gatunek = document.getElementById('gatunek');
              let wybieg = document.getElementById('wybieg');
              const deleteAnimalButton = document.getElementById('deleteAnimalButton');
              const deleteRunButton = document.getElementById('deleteRunButton');
              const modifyAnimalButton = document.getElementById('modifyAnimalButton');
              const modifyRunButton = document.getElementById('modifyRunButton');
              const warning1 = document.getElementById('warning1');
              const warning2 = document.getElementById('warning2');
              const warning3 = document.getElementById('warning3');
              const warning4 = document.getElementById('warning4');
              const warning5 = document.getElementById('warning5');
              const warning6 = document.getElementById('warning6');
              const warning7 = document.getElementById('warning7');
              const warning8 = document.getElementById('warning8');
              const runWarning = document.getElementById('runWarning');
              const runModifyWarning = document.getElementById('runModifyWarning');
              var isLoaded = false;
              var isAnimalValid = false;
              var isRunValid = false;
              var isModifyAnimalValid = false;
              var isModifyRunValid = false;

              function loadFile() {
                  const [file] = fileInput.files;

                  const url = URL.createObjectURL(file);
                  const resp = new XMLHttpRequest();
                  resp.open("GET", url, false);
                  resp.setRequestHeader("Content-Type", "text/xml");
                  resp.send(null);

                  const xmlDoc = resp.responseXML;
                  fileContent = xmlDoc;
                  addDeleteOptions();
                  isLoaded = true;
              }

              function handleSaveButton() {
                  if (fileContent === null) {
                      return alert("Nie wczytano pliku XML.");
                  }

                  const serializer = new XMLSerializer();
                  const serializedString = serializer.serializeToString(fileContent);

                  const blob = new Blob([serializedString], { type: "text/xml" });
                  const link = document.createElement("a");
                  link.href = URL.createObjectURL(blob);
                  link.download = "zoo.xml";
                  link.click();
              }

              function addDeleteOptions() {
                removeOptions();
                var wybiegi = fileContent.querySelector('wybiegi');
                for(const wybieg of wybiegi.children) {
                  var option = document.createElement("option");
                  option.text = wybieg.getAttribute('idWybiegu');
                  document.getElementById('wybieg').add(option);
                }

                const select = document.getElementById('deleteAnimal');
                var animals = fileContent.querySelector('zwierzeta');
                var i = 1;
                for(const animal of animals.children){
                  var option = document.createElement("option");
                  option.setAttribute('value',i);
                  i++;
                  option.text = animal.children[1].textContent + ' '+  animal.getAttribute('idWybiegu');
                  select.add(option);
                }

                const select1 = document.getElementById('deleteRun');
                var runs = fileContent.querySelector('wybiegi');
                i = 1;
                for(const run of runs.children){
                  var option1 = document.createElement("option");
                  option1.setAttribute('value',i);
                  i++;
                  option1.text = run.getAttribute('idWybiegu');
                  select1.add(option1);
                }

                const select2 = document.getElementById('pickAnimal');
                i = 1;
                for(const animal of animals.children){
                  var option = document.createElement("option");
                  option.setAttribute('value',i);
                  i++;
                  option.text = animal.children[1].textContent + ' '+  animal.getAttribute('idWybiegu');
                  select2.add(option);
                }

                const select3 = document.getElementById('pickRun');
                i = 1;
                for(const run of runs.children){
                  var option1 = document.createElement("option");
                  option1.setAttribute('value',i);
                  i++;
                  option1.text = run.getAttribute('idWybiegu');
                  select3.add(option1);
                }

                const select4 = document.getElementById('nowyWybieg');
                i = 1;
                for(const run of runs.children){
                  var option1 = document.createElement("option");
                  option1.setAttribute('value',i);
                  i++;
                  option1.text = run.getAttribute('idWybiegu');
                  select4.add(option1);
                }
                var eOption = document.createElement('option');
                eOption.setAttribute('value','00');
                eOption.setAttribute('selected','selected');
                eOption.text = "don't change";
                select4.add(eOption);

              }

              function addAnimal() {
                validateAnimal();
                if(isAnimalValid){
                  var zwierze = fileContent.createElement("z:zwierze");
                  var newNazwa = fileContent.createElement("z:nazwaZwierzecia");
                  var newImie = fileContent.createElement("z:imie");
                  var newWiek = fileContent.createElement("z:wiek");
                  var newWaga = fileContent.createElement("z:waga");
                  var newData = fileContent.createElement("z:dataUrodzenia");
                  newNazwa.textContent = nazwa.value;
                  newImie.textContent = imie.value;
                  newWiek.textContent = wiek.value;
                  newWaga.textContent = waga.value;
                  newWaga.setAttribute("jednostka","kg");
                  newData.textContent = data.value.replace("-",".");
                  zwierze.appendChild(newNazwa);
                  zwierze.appendChild(newImie);
                  zwierze.appendChild(newWiek);
                  zwierze.appendChild(newWaga);
                  zwierze.appendChild(newData);
                  zwierze.setAttribute("idG",gatunek.value);
                  zwierze.setAttribute("idWybiegu",wybieg.options[wybieg.selectedIndex].text);
                  fileContent.querySelector("zwierzeta").appendChild(zwierze);
                }
              }

              function addRun() {
                validateRun();
                if(isRunValid){
                  var newWybieg = fileContent.createElement('z:wybieg');
                  var newSektor = fileContent.createElement("z:sektor");
                  var newPowierzchnia = fileContent.createElement('z:powierzchnia');
                  var newType = fileContent.createElement('z:typ');
                  newSektor.textContent = sektor.options[sektor.selectedIndex].text;
                  newPowierzchnia.setAttribute("jednostka","m^2");
                  newPowierzchnia.textContent = powierzchnia.value;
                  newType.textContent = typ.options[typ.selectedIndex].text;
                  newWybieg.appendChild(newSektor);
                  newWybieg.appendChild(newPowierzchnia);
                  newWybieg.appendChild(newType);

                  var sum =0;
                  var wybiegi = fileContent.querySelector('wybiegi');
                  for(const i of wybiegi.children) {
                    sum+=1;
                  }
                  if(sum<10){
                    sum+=1;
                    newWybieg.setAttribute('idWybiegu',"W0"+ sum);
                  }
                  else{
                    sum+=1;
                    newWybieg.setAttribute('idWybiegu',"W"+ sum);
                  }

                  fileContent.querySelector("wybiegi").appendChild(newWybieg);
                }
              }

              function deleteAnimal() {
                var id = document.getElementById('deleteAnimal').value;
                var animals = fileContent.querySelector('zwierzeta');
                animals.removeChild(animals.children[id-1]);
                addDeleteOptions();
              }

              function deleteRun() {
                var id = document.getElementById('deleteRun').value;
                var runs = fileContent.querySelector('wybiegi');
                runs.removeChild(runs.children[id-1]);
                addDeleteOptions();
              }

              function removeOptions() {
                const select1 = document.getElementById('wybieg');
                const select2 = document.getElementById('deleteAnimal');
                const select3 = document.getElementById('deleteRun');
                const select4 = document.getElementById('pickAnimal');
                const select5 = document.getElementById('pickRun');
                var selects = [select1,select2,select3,select4,select5];
                for(var i=0; i<5;i++){
                  while(selects[i].firstChild){
                    selects[i].removeChild(selects[i].firstChild);
                  }
                }
              }

              function modifyAnimal() {
                validateModifyAnimal();
                if(isModifyAnimalValid){
                  var id = document.getElementById('pickAnimal').value;
                  var animal = fileContent.querySelector('zwierzeta').children[id-1];
                  var nowaNazwa = document.getElementById('nowaNazwa');
                  var noweImie = document.getElementById('noweImie');
                  var nowyWiek = document.getElementById('nowyWiek');
                  var nowaWaga = document.getElementById('nowaWaga');
                  var nowaData = document.getElementById('nowaData');
                  var nowyWybieg = document.getElementById('nowyWybieg');
                  var nowyGatunek = document.getElementById('nowyGatunek');
                  var features = [nowaNazwa,noweImie,nowyWiek,nowaWaga,null,nowaData];
                  var i=0;
                  nowaData.value
                  for(const feature of animal.children){
                    if(i!=4){
                      if(features[i].value != '00' && features[i].value !=''){
                        feature.textContent = features[i].value;
                      }
                    }
                    i++;
                  }
                  if(nowyWybieg != '00'){
                    animal.setAttribute('idWybiegu',nowyWybieg.options[nowyWybieg.selectedIndex].text);
                  }
                  if(nowyGatunek != '00'){
                    animal.setAttribute('idG',nowyGatunek.value);
                  }
                }

              }

              function modifyRun() {
                validateModifyRun();
                if(isModifyRunValid){
                  var id = document.getElementById('pickRun').value;
                  var run = fileContent.querySelector('wybiegi').children[id-1];
                  var nowySektor = document.getElementById('nowySektor');
                  var nowaPowierzchnia = document.getElementById('nowaPowierzchnia');
                  var nowyTyp = document.getElementById('nowyTyp');

                  if(nowySektor.value != '0'){
                    run.children[0].textContent = nowySektor.options[nowySektor.selectedIndex].text;
                  }
                  if(nowaPowierzchnia.value != ''){
                    run.children[1].textContent = nowaPowierzchnia.value;
                  }
                  if(nowyTyp.value != '0'){
                    run.children[2].textContent = nowyTyp.options[nowySektor.selectedIndex].text;
                  }
                }
              }

              function validateAnimal() {
                isAnimalValid = true;
                  if(!(/^[A-Z]{1}[a-z]{0,19}$/).test(nazwa.value) || nazwa.value ==""){
                    warning1.textContent ="nazwa doesnt match [A-Z]{1}[a-z]{0,19} ";
                    warning1.style.cssText=  "display: block;width: 100%;background-color: #FF2734;text-align: center;padding-top: 10px;padding-bottom: 10px;margin-bottom: 20px;border-radius: 10px;box-shadow: 2px 2px #000;";
                    isAnimalValid= false;
                  }
                  else{
                    warning1.textContent ="";
                    warning1.style.cssText="";
                  }
                  if(!(/^[A-Z]{1}[a-z]{0,14}$/).test(imie.value) || imie.value==''){
                    warning2.textContent ="imie doesnt match [A-Z]{1}[a-z]{0,14} ";
                    warning2.style.cssText=  "display: block;width: 100%;background-color: #FF2734;text-align: center;padding-top: 10px;padding-bottom: 10px;margin-bottom: 20px;border-radius: 10px;box-shadow: 2px 2px #000;";
                    isAnimalValid= false;
                  }
                  else{
                    warning2.textContent ="";
                    warning2.style.cssText="";
                  }

                  if(!(/^[0-9]{1,3}$/).test(wiek.value) || wiek.value==''){
                    warning3.textContent ="wiek doesnt match [0-9]{1,3} ";
                    warning3.style.cssText=  "display: block;width: 100%;background-color: #FF2734;text-align: center;padding-top: 10px;padding-bottom: 10px;margin-bottom: 20px;border-radius: 10px;box-shadow: 2px 2px #000;";
                    isAnimalValid= false;
                  }
                  else{
                    warning3.textContent ="";
                    warning3.style.cssText="";
                  }

                  if(!(/^[0-9]{1,4}$/).test(waga.value) || waga.value ==''){
                    warning4.textContent ="waga doesnt match [0-9]{1,4} ";
                    warning4.style.cssText=  "display: block;width: 100%;background-color: #FF2734;text-align: center;padding-top: 10px;padding-bottom: 10px;margin-bottom: 20px;border-radius: 10px;box-shadow: 2px 2px #000;";
                    isAnimalValid= false;
                  }
                  else{
                    warning4.textContent ="";
                    warning4.style.cssText="";
                  }
              }

              function validateRun(){
                isRunValid = true;
                if(powierzchnia.value == "" || !(/^[0-9]{1,4}$/).test(powierzchnia.value)){
                  isRunValid = false;
                  runWarning.textContent ="powierzchnia doesnt match [0-9]{1,4} or is null ";
                  runWarning.style.cssText=  "display: block;width: 100%;background-color: #FF2734;text-align: center;padding-top: 10px;padding-bottom: 10px;margin-bottom: 20px;border-radius: 10px;box-shadow: 2px 2px #000;";
                }
                else{
                  runWarning.textContent ="";
                  runWarning.style.cssText="";
                }
              }

              function validateModifyRun(){
                isModifyRunValid = true;
                var nowaPowierzchnia = document.getElementById('nowaPowierzchnia');
                if(nowaPowierzchnia.value != ''){
                  if(!(/^[0-9]{1,4}$/).test(nowaPowierzchnia.value)){
                    runModifyWarning.textContent ="powierzchnia doesnt match [0-9]{1,4} ";
                    runModifyWarning.style.cssText=  "display: block;width: 100%;background-color: #FF2734;text-align: center;padding-top: 10px;padding-bottom: 10px;margin-bottom: 20px;border-radius: 10px;box-shadow: 2px 2px #000;";
                    isModifyRunValid= false;
                  }
                  else{
                    runModifyWarning.textContent ="";
                    runModifyWarning.style.cssText="";
                  }
                }else{
                  runModifyWarning.textContent ="";
                  runModifyWarning.style.cssText="";
                }
              }

              function validateModifyAnimal()
              {
                var nowaNazwa = document.getElementById('nowaNazwa');
                var noweImie = document.getElementById('noweImie');
                var nowyWiek = document.getElementById('nowyWiek');
                var nowaWaga = document.getElementById('nowaWaga');
                isModifyAnimalValid = true;
                if(nowaNazwa.value != ''){
                  if(!(/^[A-Z]{1}[a-z]{0,19}$/).test(nowaNazwa.value)){
                    warning5.textContent ="nazwa doesnt match [A-Z]{1}[a-z]{0,19} ";
                    warning5.style.cssText=  "display: block;width: 100%;background-color: #FF2734;text-align: center;padding-top: 10px;padding-bottom: 10px;margin-bottom: 20px;border-radius: 10px;box-shadow: 2px 2px #000;";
                    isModifyAnimalValid= false;
                  }
                  else{
                    warning5.textContent ="";
                    warning5.style.cssText="";
                  }
                }else{
                  warning5.textContent ="";
                  warning5.style.cssText="";
                }
                if(noweImie.value != ''){
                  if(!(/^[A-Z]{1}[a-z]{0,14}$/).test(noweImie.value)){
                    warning6.textContent ="imie doesnt match [A-Z]{1}[a-z]{0,14} ";
                    warning6.style.cssText=  "display: block;width: 100%;background-color: #FF2734;text-align: center;padding-top: 10px;padding-bottom: 10px;margin-bottom: 20px;border-radius: 10px;box-shadow: 2px 2px #000;";
                    isModifyAnimalValid= false;
                  }
                  else{
                    warning6.textContent ="";
                    warning6.style.cssText="";
                  }
                }else{
                  warning6.textContent ="";
                  warning6.style.cssText="";
                }

                if(nowyWiek.value != ''){
                  if(!(/^[0-9]{1,3}$/).test(nowyWiek.value)){
                    warning7.textContent ="wiek doesnt match [0-9]{1,3} ";
                    warning7.style.cssText=  "display: block;width: 100%;background-color: #FF2734;text-align: center;padding-top: 10px;padding-bottom: 10px;margin-bottom: 20px;border-radius: 10px;box-shadow: 2px 2px #000;";
                    isModifyAnimalValid= false;
                  }
                  else{
                    warning7.textContent ="";
                    warning7.style.cssText="";
                  }
                }else{
                  warning7.textContent ="";
                  warning7.style.cssText="";
                }

                if(nowaWaga.value != ''){
                  if(!(/^[0-9]{1,4}$/).test(nowaWaga.value)){
                    warning8.textContent ="waga doesnt match [0-9]{1,4} ";
                    warning8.style.cssText=  "display: block;width: 100%;background-color: #FF2734;text-align: center;padding-top: 10px;padding-bottom: 10px;margin-bottom: 20px;border-radius: 10px;box-shadow: 2px 2px #000;";
                    isModifyAnimalValid= false;
                  }
                  else{
                    warning8.textContent ="";
                    warning8.style.cssText="";
                  }
                }else{
                  warning8.textContent ="";
                  warning8.style.cssText="";
                }

              }

              document.addEventListener("DOMContentLoaded", () => {
                  loadButton.addEventListener("click", loadFile);
                  saveButton.addEventListener("click", handleSaveButton);
                  addButton.addEventListener('click',addAnimal);
                  addButton.addEventListener('click',addDeleteOptions);
                  addRunButton.addEventListener('click',addRun);
                  addRunButton.addEventListener('click',addDeleteOptions);
                  deleteAnimalButton.addEventListener('click',deleteAnimal);
                  deleteRunButton.addEventListener('click',deleteRun);
                  modifyAnimalButton.addEventListener('click',modifyAnimal);
                  modifyRunButton.addEventListener('click',modifyRun);
              });

            </div>
          </div>
          <div class="buttons">
            <button class="button-88" role="button"><a href="../index.html" target="_blank">Formularz</a></button>
          </div>
        </div>
      </div>
    </div>
    <div id="footer">Krzysztof Deka 242377 &copy 07.01.2023</div>
    <script src="script.js"></script>
  </body>
</html>
